{% extends template.self %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ "/_layouts/css-overrides/search-input-fix.css"|resolveFile }}">
    <link rel="stylesheet" href="{{ "/_layouts/css-overrides/image-fix.css"|resolveFile }}">
    <style>
        /* Emergency inline styles for search input */
        .book-search-input,
        .book-search,
        #book-search-input,
        div[role="search"] {
            background-color: #141521 !important;
        }
        
        .book-search-input input,
        input.book-search-input,
        input[type="text"].book-search-input,
        .book-search input,
        input[placeholder="Type to search"],
        input[type="text"][placeholder="Type to search"],
        html body input[placeholder="Type to search"],
        [placeholder="Type to search"],
        .book-search-input input[type="text"],
        html body .book-search-input input,
        #book-search-input input,
        input[type="search"],
        input.book-search,
        .book-summary input {
            color: #f8f8f2 !important;
            background-color: #141521 !important;
            opacity: 1 !important;
            -webkit-text-fill-color: #f8f8f2 !important;
            border-color: #2a2c3d !important;
        }
        
        .markdown-section img {
            display: block;
            margin: 0 auto;
            max-width: 90%;
        }
    </style>
    <script>
        // JavaScript to ensure search input styling is applied after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Apply immediately
            applySearchStyles();
            
            // Also apply after a short delay (for any dynamic content)
            setTimeout(applySearchStyles, 500);
            setTimeout(applySearchStyles, 1000);
            setTimeout(applySearchStyles, 2000);
            
            // Function to apply search styles
            function applySearchStyles() {
                var searchInputs = document.querySelectorAll('input[type="text"], input[type="search"], .book-search input, #book-search-input input, .book-summary input');
                searchInputs.forEach(function(input) {
                    input.style.backgroundColor = '#141521';
                    input.style.color = '#f8f8f2';
                    input.style.opacity = '1';
                    input.style.webkitTextFillColor = '#f8f8f2';
                });
                
                var searchContainers = document.querySelectorAll('.book-search-input, .book-search, #book-search-input, .book-summary form');
                searchContainers.forEach(function(container) {
                    container.style.backgroundColor = '#141521';
                });
            }
            
            // Monitor DOM changes for dynamically added elements
            if (window.MutationObserver) {
                var observer = new MutationObserver(function(mutations) {
                    applySearchStyles();
                });
                
                observer.observe(document.body, { 
                    childList: true, 
                    subtree: true 
                });
            }
        });
    </script>
{% endblock %}

{% block body %}
    {{ super() }}
{% endblock %} 